KanColleSimulator(KCS) Ver.0.91
※等幅フォントで閲覧することを推奨します

【最終更新日】
　2016/02/27

【製作者】
　おーぷん2ch：◆RoVKHyEYUtVB
　Twitter：@YSRKEN

【概要】
　パラメータから戦闘結果をシミュレートするソフトウェアデース！
　先人たちが残した種々のデータを元にしています。感謝しますね！
　ちょっと(記述量が)重い感じもしますけれど、でも、頑張ります！
　お役に立ちましたか？　そう、なら、頑張った甲斐がありました！

【もうちょっと詳しい概要】
・既知の検証結果から、艦これの戦闘をシミュレートすることができます。
・平均残り耐久、勝率などの統計的なデータを収集することも可能です。
・データは外部のテキストデータから読み込ませて使用します。
　これにより、いちいち再コンパイルしなくても任意の艦娘を再現できます
・コマンドラインアプリケーションです。引数によって制御します。
・ランタイムエラーが出た際は、
　「Visual Studio 2015 の Visual C++ 再頒布可能パッケージ」
　(https://www.microsoft.com/ja-jp/download/details.aspx?id=49984)
　をインストールすれば動くはずです。
・どういうわけか、そのまま実行してもコマンドプロンプトに結果が表示されません。
　恐らくコンパイラ関係のトラブルかと思われます。GUI版の動作には影響ありませんが、
　結果確認にはリダイレクト機能によるログ書き出しを行ってください(run.bat参照)。

【ファイル・フォルダ構成】
　KanColleSim.exe……Visual Studio 2015で作成された実行ファイル。
　converter.exe……テキストから艦隊データに変換するためのミニツールです。説明略。
　Readme(CUI).txt……この文書です。このソフトウェアについての説明が書かれています。
　Format.txt……装備データ・艦娘データ・艦隊データの仕様について詳しく
　　　　　　　　記された文書です。こちらも必ず読むようにしてください。
　weapon.csv……装備データ。CSV形式で書かれています。ソフトに必須なので、
　　　　　　　　決して名前を書き換えないでください。
　kammusu.csv……艦娘データ。CSV形式で書かれています。ソフトに必須なので、
　               決して名前を書き換えないでください。
　slotitems.csv……装備データその2(JSON読み込み用)。
　ships.csv……艦娘データその2(JSON読み込み用)。
　fleets*.txt,fleets*.json……艦隊データのサンプル。
　*.map……マップデータ。
　run.bat……このソフトの機能を分かりやすく紹介するためのサンプルバッチファイル
　           です。とりあえずクリックしてみてください。
　source\CUI……C++11で記述されたソースコードが入ってあります。

【操作説明】
　コマンドラインオプションは次の通りです。どこの項目も必須なので注意。
「KanColleSim <試行回数> <艦隊(先攻)> <艦隊(後攻)> <陣形(先攻)> <陣形(後攻)>」

・試行回数は1以上の自然数で入力してください。
　1である時は、シミュレートされた戦闘結果を経過付きで表示します。
　それ以上である時は、戦闘を複数回行った際の平均残り耐久・勝率・
　敗北D〜完全勝利Sまでの割合を表示します。
・艦隊は、後述するファイルフォーマットに従って入力されたテキストデータです。
　具体的には、司令部レベル・所属する艦娘・各艦娘の装備・各艦娘のコンディション
　を指定できます。特にコンディションは、戦闘開始時残り耐久・cond値・
　残り弾薬(％)・残り艦載機数を指定することが出来ます(略すことも可能)。
　Ver.0.85から、艦載機厨氏のデッキビルダー形式にも対応しました。
・陣形は、単縦陣・複縦陣・輪形陣・梯形陣・単横陣から選択します。
・先攻と後攻ですが、先攻は「今操作してる提督側」「左側」で大体イメージできる
　でしょう。深海棲艦は常に後攻ですね。仕様上先攻がかなり有利に出来ているので、
　勝率を推測する際などは注意が必要です。
☆艦隊(後攻)に*.mapをあてがうと自動的にマップモードになります。この際は、自軍において
　通常戦闘→単縦陣、対潜マス(敵旗艦が潜水艦)→単横陣、開幕夜戦→陣形(先攻)で指定したもの
　として処理されます(敵陣形はマップデータ内に記述)。

 【サンプルデータ】
・fleets1.txt……しばふ艦隊。しばふ艦がサンプル向きなのは確定的に明らか
・fleets2.txt……デバッグ用艦隊。fleets1に存在しない艦種のみで編成されました
・fleets3.txt……1-5用対潜艦隊
・fleets4.txt……3-5上ルート用艦隊(重巡版)
・fleets5.txt……3-5上ルート用艦隊(潜水版)
・fleets6.txt……2-5上ルート用艦隊
・fleets7.txt……16冬E3第二艦隊用艦隊(阿武隈版)
・fleets8.txt……16冬E3第二艦隊用艦隊(神通版)
・fleets9.txt……16冬E1艦隊(4スロ軽巡版)
・fleets10.txt……16冬E1艦隊(雷巡版)
・fleets11.json……デッキビルダー読み込みテスト用艦隊
・1-5_high.map……司令部レベル100以上での1-5を模したマップデータ
・3-5削り_上_high.map……司令部レベル100以上での3-5上ルートを模したマップデータ
・2-5削り_上_high.map……司令部レベル100以上での2-5上ルートを模したマップデータ
・16冬E3ラスダン_第二艦隊想定_甲.map……そのままの意味
・16冬E1削り_甲.map……そのままの意味

【注意事項】
・このソフトウェアを用いて生じた損害については一切責任が取れません
・いわゆる「轟沈ストッパー」は、ゲームの仕様上自軍にだけ存在しています。
・デフォルトでは疲労なし・補給バッチリ・体力満タンにしています
　(艦隊データによってはその辺りを変化させることも可能)
・装備に関する制限は設けていませんので、それこそ駆逐艦に46cm砲を搭載
　することも可能です。ただし、例えば金剛型に41cm以上の砲を積んだ場合など、
　特定の組み合わせで起こりえるシナジー(フィット補正など)に対応しています
・索敵計算式は2-5(秋)をデフォルトとしています
　(ヘッダーファイルの書き換えで2-5(旧)にも対応できるようにしています)
・工作艦、揚陸艦、潜水母艦、給油艦には仕様上対応していません
・マップモードにて、
・「索敵の成功条件」
　「敵艦載機の防空迎撃による損害」
　「弾着観測射撃の発動確率」
　「改修による命中率上昇度合い」
　「探照灯による誘引率」
　「探照灯改修による誘引効果増大」
　「空母の攻撃におけるクリティカル率上昇」
　については、情報がないので憶測で書いています。また、
　「支援艦隊」
　「対空カットイン」
　「航空戦、空襲戦マス」
　「16inch三連装砲 Mk.7のフィット補正」
　については、シミュレートするのに必要な情報が少ない
　こともあって対応していません。
・weapon.csvに比べてkammusu.csvが手抜きな理由……搭載数写す時に心が折れましたorz
・フィット補正は次の表のようにしました。言葉の意味は次のページと同じ意味です。
　http://ch.nicovideo.jp/biikame/blomaga/ar850895
　名前                     伊勢戦     扶桑戦     伊勢航戦   扶桑航戦   大和     長門       金剛       ビス       イタ
　35.6cm連装砲             バニラ     バニラ     フィット   フィット   バニラ   フィット   フィット   フィット   フィット
　35.6cm連装砲(ダズル迷彩) バニラ     バニラ     フィット   フィット   バニラ   フィット   フィット   フィット   フィット
　試製35.6cm三連装砲       バニラ     バニラ     フィット   フィット   バニラ   フィット   フィット   フィット   フィット
　38cm連装砲               バニラ     バニラ     フィット   フィット   バニラ   バニラ     フィット   フィット   バニラ
　38cm連装砲改             バニラ     バニラ     フィット   フィット   バニラ   バニラ     フィット   フィット   バニラ
　381mm/50 三連装砲        バニラ     バニラ     フィット   フィット   バニラ   フィット   過積載(小) バニラ     フィット
　381mm/50 三連装砲改      バニラ     バニラ     フィット   フィット   バニラ   フィット   過積載(小) バニラ     フィット
　41cm連装砲               フィット   フィット   バニラ     フィット   フィット フィット   過積載(小) 過積載(小) 過積載(小)
　試製41cm三連装砲         フィット   フィット   バニラ     フィット   フィット フィット   過積載(小) 過積載(小) 過積載(小)
　46cm三連装砲             過積載(大) 過積載(大) 過積載(大) 過積載(大) バニラ   過積載(小) 過積載(大) 過積載(大) 過積載(大)
　試製46cm連装砲           過積載(大) 過積載(大) 過積載(小) 過積載(小) バニラ   過積載(小) 過積載(小) 過積載(小) 過積載(大)

【バージョン履歴】
○Ver.0.91　2016/02/27
　・速吸は夜戦攻撃可能なので修正した。
　・バルジの効果(装甲強化)が効いていなかったので修正した。
　・雷撃のダメージを修正した。

○Ver.0.9　2016/02/25
　・雷撃戦命中率を、次のURLに従い修正した。
　　https://twitter.com/Xe_UCH/status/700169825121804288
　・航空戦計算を最新版に修正した。
　　(恐ろしいことに、攻撃機の雷装が効かなくなっていたので修正した)
　・その過程で、二式大艇ちゃんもガンガン触接に参加するようになったかも！
　・対空カットインを試験的に実装した。
　・JSON読み込み時、ケッコン後の耐久値を変更していなかったので修正した。
　・給油艦、飛行艇母艦を実装した。
　　(艦攻装備給油艦は夜戦出来ませんよね？)
　・ダメージ計算式における切り捨てタイミングを修正した。
　・内部熟練度に対応した(ただしJSON読み込みではなくtxt読み込みのみ)
　・GUIでの制空値表示に熟練度が反映されてなかったので修正した。
　　(ただし内部熟練度は外部熟練度に翻訳されます)

○Ver.0.85　2016/02/24
　・クリティカル率の式を微修正した。
　・WG42は複数持ちすると威力がよりアップするのでそのように修正した。
　・開幕夜戦マスでも、旗艦が潜水艦なら単横陣とするようにした。
　・デッキビルダー形式の入力に対応。それに伴い、ほっぽアルファの
　　ships0209.csvとslotitems0209.csvを利用させてもらいました

○Ver.0.8　2016/02/22
　・MSVC＋clangでコンパイルし直そうとしたのですが、
　　「ソースの文字コードがShift_JISだと容赦なくハネられる」→
　　「UTF-8に直したら例外を投げる＆受け取る部分でコンパイルエラー」→
　　「不思議とコンパイルオプションにも異常は見当たらない」→
　　「clang用にプロジェクトを作成し直して実行すると実行時abort()」→
　　「プロジェクトを破棄しMinGW＋clangでコンパイルしようとするもダメ」→
　　「cmathのhypot回りでの未定義エラー？MinGWのバグのせいかよ！」→
　　「オプションの-std=c++11を-std=gnu+11に書き換え再度挑戦」→
　　「今度はリンクエラーだが-std=gnuだと出ないはず……？」→
　　「こ　れ　は　使　い　も　の　に　な　ら　な　い」
　　というわけで断念しました。悪しからず
　・戦闘回数を2回以上にコマンドラインで指定した際、総演算時間を表示するようにした
　・「出撃した際にボス戦で旗艦を撃沈した確率」も出すようにした
　・深海棲艦は通常Lv1だが潜水艦はLv50だそうなのでkammusu.csvを修正した
　・96式150cm探照灯は普通の探照灯より攻撃を吸うらしいので一応反映してみた
　・重巡棲姫(甲ラスダン)をテキトーに実装したが、情報は憶測で書かれた部分もあります
　・通常モードにおける「MVP表示」「MVP率表示」を実装した
　・勝利した際のcond値の変化を実装する
　・対潜攻撃の計算式を修正した
　・装備改修を実装した(ダメージ補正は最新だが、命中補正は試験実装)
　・サンプル艦隊の情報も修正した
　・大破要因の％が合計100％でなかったバグを修正した
　・艦載機熟練度を実装した
　・探照灯は改修で誘引効果がアップするそうなので試験的に実装した
　・陸上棲姫には雷装値が通じないことが反映されていなかったので修正した
　・空母の火力計算式を更新した
　・空母の攻撃におけるクリティカル率上昇を試験的に実装した
　・GUI上でも装備改修や熟練度を編集できるようにした

○Ver.0.7　2016/02/17
　・ターゲッティングは、他装備や庇うを無視した場合、一様乱数とのこと
　・旗艦への攻撃を他が庇う確率が40％になるように修正した
　・マップデータの書式が一部変更になったので明記した
　・開幕夜戦マスに対応した
　・両方艦載機無しで「制空権確保」していたのを修正
　・ちゃんと一戦ごとに弾薬が減少するようにした
　・装甲乱数、およびカスダメの計算式を修正した
　・夜戦カットイン率の式を最新版に修正した。その過程で主魚カットインも実装した
　・命中率アルゴリズムを最新版に修正した
　　(ただし現状は昼戦砲撃戦のものを他に使い回している)
　・戦艦のフィット砲補正を最新版に修正した
　・軽巡のダメージ補正を実装した
　・練習巡洋艦、熟練見張員、徹甲弾補正を実装した
　・探照灯の誘引効果を仮実装した
　・艦娘と深海棲艦で制空への対応が違うのでそこを修正した

○Ver.0.6　2016/02/13
　・今までの「大破率」は大破と撃沈の合計だったので、
　　「大破率」と「撃沈率」を別に表記するようにした
　・マップモードを実装した。これにより海域突破率などをシミュレートできます
　・深海棲艦な潜水艦における開幕魚雷の対応を修正した
　・昼戦で終了できるようにした
　・阿武隈改二への対応させた
　・潜水艦に開幕爆撃はできないので修正した
　・敵空母およびグラーフは夜戦攻撃可能なようにした
　・敵雷巡は開幕雷撃不可、しかし航空戦艦レ級は開幕雷撃可能なものもある
　・輸送艦、護衛要塞、陸上棲姫も追加した
　・陸上棲姫に対する三式弾特効・雷撃無効・爆撃機搭載時の挙動も追加した

○Ver.0.51　2016/02/09
　・とりあえずGUIも乗っけた
　・敵艦隊と自艦隊の艦隊数が違う場合に例外を吐くことがある不具合を修正した

○Ver.0.5　2016/02/07
　・初版(CUIのみ)
　・撃沈ストッパー処理を入れた
　・阿武隈改二へ対応させた

【参考】
・Wikiの「戦闘について」とその関連ページ
・http://bs-arekore.at.webry.info/201502/article_4.html
・http://zekamashi.net/kancolle-kouryaku/dantyakukansokusyageki/
・http://ch.nicovideo.jp/ginga_kuon/blomaga/ar890633
・http://ch.nicovideo.jp/biikame/blomaga/ar850895
・https://twitter.com/Xe_UCH/status/700169825121804288
・おーぷん本スレの皆さん

【ライセンス】
MITライセンスとします。ただし、BSDライセンスの「picojson」
(https://github.com/kazuho/picojson)も併用しています。

【連絡先】
ysr.ken@gmail.com
